---
title: "[Tableau] 태블로 신병훈련소 17기 7일차"
excerpt: "#Tableau #신병훈련소 #데이터_시각화 #도넛차트 #워터폴차트 #범프차트 #퍼널차트 #간트차트"

categories:
  - tableau
tags:
  - [tableau, data_visualization]

permalink: /tableau/bootcamp-17-7/

toc: true
toc_sticky: true

date: 2023-02-14
last_modified_at: 2023-02-14
---

##  ✏️ 7일차

> 📖 7일차 학습 안내  
> - 도넛 차트
> - 워터폴 차트
> - 범프 차트
> - 퍼널(깔때기) 차트
> - 간트 차트


### 💡 범프 차트(Bump Charts)

- 라인 차트의 일종으로 **시간 흐름에 따른 순위 변화**를 보여주는 차트
- 기간의 시작과 끝에 대한 순위와 시간에 따른 순위 변화를 쉽게 집계할 수 있음
- 범프 차트 만들기
   1. 행 선반의 초록 알약 > 퀵 테이블 계산 > `순위` 선택
   2. 다음을 사용하여 계산 > 확인하고자 하는 카테고리 선택
   3. **불연속형**으로 변경 > 마크 선반의 유형을 **라인**으로 변경

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_1.png){: .align-center}

<br>

### 💡 워터폴 차트(Waterfall Charts)

- 각 제품이나 연도, 단계와 같은 카테고리에 따라 **누적 값과 기여도를 동시에** 볼 수 있음
- 워터폴 차트는 특정 측정값(대개 양수와 음수 값이 있는)이 하나의 차원을 따라가며 누적되는 것을 보여줌
- 차원의 각 멤버가 총계에 대해 얼마나 기여하는지에 대해 나타냄 (양수, 음수 가능)
- 워터폴 차트 만들기
  1. 측정값의 집계 기준을 **누계**로 변경(퀵 테이블 계산 > `누계` 선택)
  2. 마크 선반의 유형을 **간트 차트**로 변경
  3. 측정값의 마이너스 값으로 계산된 필드 만들기
     - 각 간트 막대의 높이가 이전 막대 높이로 바뀌면서 값이 음수인 막대는 위쪽으로, 양수인 막대는 아래쪽으로 늘어나게 됨
     - 측정값에 마이너스 붙인 형태로 계산된 필드 생성
  4. 생성된 **마이너스 측정값**을 마크 선반의 **크기**에, 원 측정값을 마크 선반의 **색상**에 Drag & Drop
- 워터폴 차트는 불연속형 차원을 따라 하나의 측정값을 표시해서 만드는 형태

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_2.png){: .align-center}

<br>

### 💡 깔때기(퍼널) 차트(Funnel Charts)

- 퍼널 차트는 사용자의 단계별 이탈율 혹은 전환율을 보여줌
- 몇 명의 가망 고객(prospect)이 영업 퍼널의 각 단계에 위치해 있는지, 혹은 몇 명의 지원자가 인터뷰의 어떤 과정을 거치고 있는지 등을 확인할 수 있음

> 🤔 우리 영업 사이클에 몇 명의 고객이 있고 어느 단계에 해당하는가?

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_3.png){: .align-center}

<br>

> 좀 더 Smooth한 퍼널 차트 만들기

- **행** 선반에 **Phase**, **열** 선반에 **Number of Prospects** 추가
- 마크 유형을 **영역**으로 변경한 후 깔때기 모양을 만들어주기 위해 'Number of Prospects' 필드에 마이너스를 붙여 '**Negative Number of Prospects**' 필드 생성 후 열 선반 왼쪽에 추가   
 
![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_4.png){: .align-center}

<br>

### 💡 도넛 차트(Donut Charts)

- 각 데이터의 “비중”이 얼마나 되는지 표현하기 위한 차트 중 하나

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_5.png){: .align-center}

<br>

### 💡 날짜 함수 - DATEDIFF 함수

- [태블로에서 사용되는 날짜 함수](https://help.tableau.com/current/pro/desktop/ko-kr/functions_functions_date.htm#%ED%95%A8%EC%88%98)
- **DATEDIFF** 함수는 **두 날짜 사이의 날짜 부분(주, 년 등) 수**를 반환
- 구문

  ```
    DATEDIFF(date_part, date1, date2, [start_of_week])
  ```

<br>

#### 👀 date_part 인수

- Tableau의 수많은 날짜 함수는 **일, 주, 분기 등**과 같이 **고려해야 할 날짜 부분을 함수에 알려주는 문자열 상수**인 **date_part 인수**를 사용


|DATE_PART|	값|
|----|----|
|'year'|	4자리 연도|
|'quarter'|	1-4|
|'month'	|1-12 또는 "1월", "2월" 등|
|'dayofyear'|	일년 중 몇째 날. 1월 1일은 1, 2월 1일은 32 등으로 계산|
|'day'|	1-31|
|'weekday'|	1-7 또는 "일요일", "월요일" 등|
|'week'|	1-52|
|'hour'|	0-23|
|'minute'|	0-59|
|'second'|	0-60|
|'iso-year'|	4자리 ISO 8601 연도|
|'iso-quarter'|	1-4|
|'iso-week'|	1-52, 주의 시작은 항상 월요일|
|'iso-weekday'|	1-7, 주의 시작은 항상 월요일|


<br>

### 💡 시간 단위 간트 차트(실습)

- Dataset

    ![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_6.png){: .align-center}


- DATEDIFF 함수 사용하여 날짜 간 기간 계산
- 데이터 확인시 날짜 데이터가 초 단위까지 있기 때문에 date_part 인수를 '**second**'로 설정 후 날짜 단위로 변경해줘야 함
  - 기간 계산 필드 생성("**Duration in days**")
  
    ```
    (DATEDIFF('second',[Start],[Stop]))/86400
    ```

- 차트에 **기간만큼 영역 표시**하기 위해서는 **간트 차트**로 마크 유형 설정되어 있는 상태에서 **기간 필드를 "크기"에 Drag & Drop**  
- 이중 축 활용하여 간트 차트 위에 모양 추가

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_7.png){: .align-center} 

<br>

### 💡 파레토 차트(Pareto Charts)

- 자료들이 어떤 범주에 속하는가를 나타내는 계수형 자료일 때 각 범주에 대한 빈도를 막대의 높이로 나타낸 차트 [(위키백과)](https://ko.wikipedia.org/wiki/%ED%8C%8C%EB%A0%88%ED%86%A0%EB%8F%84)
- 차원의 항목 몇 개가 전체 측정값의 몇 퍼센트를 차지하는지 볼 때 사용
- **80%의 결과가 20%의 원인에서 발생한다는 파레토 원칙**에 기반을 두고 있음
- 차원의 고유 카운트 및 측정값에 대해 테이블 계산을 사용하여 **누계에 대한 구성 비율** 계산 ('보조 계산 추가' 사용)

    ![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_8.png){: .align-center}

- 파레토 차트의 경우, 라인 차트와 막대 차트가 모두 필요하므로 측정값에 대한 막대 차트 추가(두 차트가 겹치도록 이중축 설정)
- 차원 고유 카운트의 20% 및 측정값의 80%에 대한 참조선 추가

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_9.png){: .align-center}



<br>

##  ✏️ 7일차 과제

### 1️⃣ 도넛 차트

```
2016년부터 2019년까지 연도 별로 슈퍼스토어의 고객세그먼트 별 매출 비중이 어떻게 바뀌었는지 살펴보기  
- 사용 Data: 슈퍼스토어 - 샘플
```


<details>
<summary>최종결과 🌈</summary>
<div markdown="1">       

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_10.png){: .align-center}  


</div>
</details>

<br>

1. 파이 차트 만들기
   1. '**주문 날짜**' 필드를 열 선반에 놓아서 연도 별 파이 차트가 들어갈 공간 마련
   2. 마크 선반의 유형을 **파이 차트**로 설정
   3. 색상은 '**세그먼트**'로, 각 파이의 크기(각도)는 '**매출**'로 각각 Drag & Drop
   4. **'세그먼트'와 '매출' 필드를 레이블에 추가**
      - 파이 차트를 사용하는 경우 파이의 크기에 대한 구분이 명확하지 않을 수 있기 때문에 추가 정보 활용 필수!

2. 파이 차트보다 작은 원 만들어 도넛 모양으로 만들기
   - 파이 차트에는 축이 존재하지 않지만, 두 개의 차트를 하나로 합쳐주기 위해서는 축이 필요
   - 이럴 경우 **임의의 축**을 생성하여 하나로 합쳐질 수 있도록 함
   - 자주 사용되는 방법 중 하나가 **MIN 함수 이용**
   1. **행 선반의 빈 공간을 더블 클릭** 하면 계산식을 바로 입력할 수 있는 빈 알약 생성
   2. 빈 알약에 **MIN(0)** 을 입력하여 하나의 임의의 축 생성 (파이 차트의 축 생성)
   3. 합칠 원을 위한 축 만들기
      1. 위와 같은 방법으로 **MIN(0)** 축 생성
      2. **마크 타입을 원**으로 바꾸고, **색상**에서 세그먼트를 빼고 **흰색**으로 지정
      3. **세부 정보**에 있는 **매출**을 **레이블**로 이동
         - 레이블 편집 > 'TOTAL SALES'라는 정보 추가
3. **이중축**으로 2개의 축 합치고, 원의 마크 크기를 조정하여 도넛 모양으로 만들기

<br>

### 2️⃣ 워터폴 차트


```
월 별 수익을 워터폴 차트 형태로 살펴보기  
- 사용 Data: 슈퍼스토어 - 샘플
```

<details>
<summary>최종결과 🌈</summary>
<div markdown="1">       

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_11.png){: .align-center}  

</div>
</details>

<br>

- 필터: 주문 날짜 **2019년**, 제품 중분류 **미술용품**

1. 열 선반에 주문날짜 이용한 불연속형 '**월**', 행 선반에 '**수익**' 추가
2. 워터폴 차트는 기본적으로 **“누적”된 값**을 기준으로 보여지는 것이기 때문에 수익을 누적 값으로 만들어야 함 
   - **“합계(수익)”**에서 마우스 오른쪽 클릭 > 퀵 테이블 계산 > `누계` 선택
      - 집계의 범위: 테이블 전체  
3. 마크 유형을 “**간트 차트**”로 변경 👉 마크가 선 모양으로 바뀜
4. 워터폴 차트에서의 크기가 아래쪽으로 표현되어야 하기 때문에 **마이너스 수익**을 계산된 필드로 생성해야 함
   - 마크의 **크기**를 '**수익**'으로 표현한 상태에서 해당 '**합계(수익)**'을 더블 클릭하여 **맨 앞에 "-"입력** (선반에서 편집)
   - 수익 값을 마이너스로 바꿔주고 막대의 방향을 바꿔주는 것 
5. 마크의 **색상**도 “**수익**”으로 표현
6. 결과를 확실히 보기 위해서 **“분석”탭** > “**총계**”를 **행 총합계**에 드래그
   - 오른쪽에 '총합계' 마크 생성
7. “**제품 중분류**” 필터 > “**미술용품**” 선택


<br>

### 3️⃣ 범프 차트


```
분기별 판매 상품 순위 변동 차트로 시각화  
- 사용 Data: 슈퍼스토어 - 샘플
```

<details>
<summary>최종결과 🌈</summary>
<div markdown="1">       

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_13.png){: .align-center}  

</div>
</details>

<br>

1. 분기별 제품 판매 순위 라인차트로 표현
   1. **연속형 '분기'** 열 선반에, '**매출**' 필드 행 선반에 추가
      - '**중분류**' 별로 색상 구분
   2. 행 선반의 '합계(매출)' 필드 > 퀵 테이블 계산 > `순위` 선택
   3. 행 선반의 '합계(매출)' 필드 > **다음을 사용하여 계산** > `중분류` 선택
   
       > 🤔 **왜 이 단계가 필요할까?**
      
        ![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_12.png){: .align-center}

       - 중분류를 기준으로 지정해 주었을 때와, 그렇지 않았을 때의 라인 그래프 비교
       - 순위는 상대적인 개념이기 때문에 계산을 할 **기준**이 필요
       - 전체를 기준으로 하게 되면 중분류 기준으로의 순위를 제대로 표현하지 못함
   4. 왼쪽 축 > 축 편집 > 눈금 > **반전**
   5. 보통의 라인 차트는 내림차순으로 축이 설정되지만, 순위의 경우 1위부터 오름차순의 형태로 보는 것이 더 효과적이기 때문
2. **원 모양 마크 타입으로 만들어 이중 축으로 표현**
   1. 행 선반의 '**합계(매출)**' 필드를 `Ctrl + Drag` 하여 복제
   2. 복제된 필드의 마크 타입을 **원**으로 변경 후 크기 알맞게 조정
   3. 레이블을 클릭하여 '**마크 레이블 표시**'에 체크 후 각 레이블이 원의 가운데에 위치하도록 정렬
   4. 이중 축 설정 후 축 동기화 (혹은 이중 축으로 만든 축 반전)
   

<br>

### 4️⃣ 퍼널 차트


```
앱 impression (노출)부터 install (설치)까지 상황을 퍼널로 시각화 해보기  
- 사용 Data : Apple Ads Report
```

<details>
<summary>최종결과 🌈</summary>
<div markdown="1">       

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_14.png){: .align-center}  


</div>
</details>

<br>


1. “**측정값**”을 열 선반에, “**측정값 이름**”을 행 선반에 추가
   - 측정값과 측정값 이름을 통해 여러 개의 측정값을 시각화

2. “측정값 이름”을 필터에 놓고 필요한 측정값만 선택 (Impressions, Taps, Installs)

4. Impressions, Taps, Installs 순으로 액티비티가 발생하므로 측정값의 순서를 변경 (내림차순 정렬)

5. 마크의  형태를 **영역**으로 변경 

6. [퍼널 반쪽 완성하기] 열 선반에 있는 측정값을 옆으로 `Ctrl + Drag` 하여 복제

7. 왼쪽 측정값 축 > 눈금 > `반전` 선택하여 왼쪽에 있는 퍼널을 돌려주기

8. 열 선반의 오른쪽 측정값을 해당 마크 선반의 레이블에 Drag & Drop 하여 레이블 표시 

<br>

### 5️⃣ 간트 차트


```
매장 별 오픈 시간과 마감 시간, 영업시간 한 눈에 살펴보기  
- 사용 Data: 스타벅스 매장 정보
```

<details>
<summary>최종결과 🌈</summary>
<div markdown="1">       

![image](/assets/images/posts_img/tableau_bootcamp/day7/20230214_tableau_bootcamp_17_7_14.png){: .align-center}  


</div>
</details>

<br>

- 고려 사항
    1. **영업시작시간 필드를 이용해 X축(열)을 “분”으로 표현**
        - “분”은 “**연속형**”으로 나타내야 함 
    2. **시도 필터를 선택했을 때 해당되는 시군구 필터만 보이도록 할 것** (대화형 필터) 
    3. **마크에 영업시작시간과 영업종료시간 표현** 
        - 마크 창에 있는 레이블에 영업시작시간과 영업종료시간을 추가한 후, 레이블 편집 

1. 마크 형태에서 “**간트 차트**” 선택 
2. **매장명**을 행에 놓고, 열에 “**영업시작시간(분)**”을 가져다 놓으면 매장 별 영업시작시간을 나타내는 조그마한 막대 생성
3. 막대의 “크기”를 영업시간으로 놓아 각 매장 별 영업 시간 확인  
     1)  계산된 필드 만들기를 이용해 “**영업 시간**” 필드 만들기
     2)  2일차처럼 DATEDIFF 함수를 이용해서 차이를 계산할 수도 있고, 시간 자체 값을 연산식에 바로 대입해 계산하는 것도 가능 
           - `[영업종료시간] - [영업시작시간]` 

4. 계산식을 통해 만들어 놓은 ‘영업시간’ 필드를 마크 선반의 크기에 Drag & Drop 
     - 3에서 만들어진 ‘영업시간’은 **1일을 기준으로 환산**된 값 
         - 해당 계산식에서 *24를 하면, 시간
         - 해당 계산식에서 *24*60 하면, 분 
         - 해당 계산식에서 *24*60*60 하면, 초 수준으로 값 확인할 수 있음
     - 해당 문제에서는 1일을 기준으로 하고 있으므로 계산식에 값을 곱해 수준 변경 없이 진행


<br><br>